{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u684C\\u9762\\\\FYP\\\\\\u672C\\u5730git\\u4ED3\\u5E93\\\\react-sidebar-v1\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './App.css';\nimport Navbar from './components/Navbar';\nimport { BrowserRouter as Router, Switch } from 'react-router-dom';\nimport Editor from './components/Editor';\nimport useLocalStorage from './hooks/useLocalStorage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [html, setHtml] = useLocalStorage('html', '');\n  // const [css, setCss] = useLocalStorage('css', '')\n  // const [js, setJs] = useLocalStorage('js', '')\n  const [srcDoc, setSrcDoc] = useState('');\n  const Conversion = \"\\\\\";\n  useEffect(() => {\n    // function getHTMLFromServer(){\n    //   const doc = fetch('http://127.0.0.1:5000/getHTML')\n    //    .then(function(response) {\n    //       return response.text()\n    //   })\n    //   .catch(function(err) {\n    //   console.log(err);\n    //    })\n    //    .then(\n    //     res => {\n    //       setHtml(res)\n    //     }\n    //   );\n    //   console.log(doc)\n    //   return doc\n    // }\n    // getHTMLFromServer()\n\n    const timeout = setTimeout(() => {\n      setSrcDoc(`\n        ${html}\n        <style>\n        *{\n          -moz-user-select:none;/*火狐*/\n          -webkit-user-select:none;/*webkit浏览器*/\n          -ms-user-select:none;/*IE10*/\n          -khtml-user-select:none;/*早期浏览器*/\n            user-select:none;\n      }\n        .selected{\n          position:relative;\n          cursor:pointer;\n          }\n       .selected:after{\n            }\n       .selected:hover:after{\n          position:absolute;\n          left:0;\n          width:100%;\n          height:100%;\n          background-color:red;\n          opacity:.3;\n          pointer-events: none;\n          content:\"\"\n         }\n        </style>\n        <script>\n      \n      \n   \n        function countNum(arr,element){\n           let count = 0;\n           for(let i=0;i<arr.length;i++){\n              if(arr[i]==element){\n                count++\n              }\n           }\n           return count\n        }\n\n        function getLine(word,wordNum){\n          let html = localStorage.getItem(\"codepen-clone-html\");\n          let stack =[]\n          let line=1;\n          for(let i=0;i<html.length;i++){\n            //判断首字母相同\n            if(word[0]==html[i]){\n                      \n            //判断字符出现的位置，并限定字符出现在><之间\n            if(html.substr(i,word.length)==word&&html[i-1]==\">\"&&html[i+word.length]==\"<\"){\n                stack.push([i])\n                i=i+word.length\n            }\n           }\n          }\n          let ch = 0;\n          for(let i=0;i<=stack[wordNum];i++){\n            if(html[i]!=\"${Conversion}${Conversion}\"){\n              ch++\n            }\n            if(html.substr(i,2)==\"${Conversion}${Conversion}n\"){\n              line++\n              ch=0;\n           }\n          }\n          return JSON.stringify({\n            line: line-1,\n            ch: ch-2+word.length\n          })\n        }\n        \n        window.addEventListener('scroll', function() {\n          localStorage.setItem(\"scrollTop\", document.documentElement.scrollTop)\n        })\n\n        window.onload=function(){\n          let stack=[];\n\n          let allEvent = document.getElementsByTagName(\"*\");\n\n          //获取编辑器\n          let editor = window.parent.document.querySelector('.CodeMirror').CodeMirror; \n          document.documentElement.scrollTop = localStorage.getItem(\"scrollTop\")\n          \n          //获取navbar\n          let navbar = window.parent.document.getElementsByClassName(\"navbar\")[0]\n          let navbarMenu = window.parent.document.getElementsByClassName(\"nav-menu\")[0]\n          let menuBars = window.parent.document.getElementsByClassName(\"menu-bars\")[0]\n\n          //防止editor失去焦点\n          document.onmousedown=function(event){\n            event.preventDefault();\n          }\n          navbar.onmousedown=function(event){\n            event.preventDefault();\n          }\n          // navbarMenu.onmousedown=function(event){\n          //   event.preventDefault();\n          // }\n          menuBars.onmousedown=function(event){\n            event.preventDefault();\n          }\n          \n\n          for(let i=0;i<allEvent.length;i++){\n            //选择内容非空且没有孩子元素的节点\n            if(allEvent[i].children.length==0 && allEvent[i].innerHTML!=\"\"){\n                stack.push(allEvent[i].innerHTML);\n                allEvent[i].classList.add('selected');\n                allEvent[i].setAttribute(\"selectedId\",countNum(stack,allEvent[i].innerHTML)-1);   \n                allEvent[i].onclick=function(e){\n                  \n                  //防止失去焦点\n                  e.preventDefault();\n \n                  //阻止冒泡\n                  e.stopPropagation();\n                  localStorage.setItem(\"location\",getLine(this.innerHTML,parseInt(this.getAttribute(\"selectedId\"))));    \n                  console.log(localStorage.getItem(\"location\"))\n                  editor.setCursor(JSON.parse(localStorage.getItem(\"location\")));\n              }                \n            }          \n          \n           }                       \n          }\n          </script>\n      `);\n    }, 250);\n    return () => {\n      clearTimeout(timeout);\n      // clearInterval(timer)\n    };\n  }, [html]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Switch, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"onlineEditor\",\n      className: \"pane_editor top-pane\",\n      children: /*#__PURE__*/_jsxDEV(Editor, {\n        language: \"xml\",\n        displayName: \"HTML\",\n        value: html,\n        onChange: setHtml\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pane_iframe\",\n      children: /*#__PURE__*/_jsxDEV(\"iframe\", {\n        id: \"iframe\",\n        srcDoc: srcDoc,\n        title: \"output\",\n        sandbox: \"allow-scripts allow-same-origin\",\n        frameBorder: \"0\",\n        width: \"100%\",\n        height: \"100%\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n_s(App, \"b882b6PXwgz7iEHr8haIEf4C1D0=\", false, function () {\n  return [useLocalStorage];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","Navbar","BrowserRouter","Router","Switch","Editor","useLocalStorage","App","html","setHtml","srcDoc","setSrcDoc","Conversion","timeout","setTimeout","clearTimeout"],"sources":["D:/桌面/FYP/本地git仓库/react-sidebar-v1/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './App.css';\r\nimport Navbar from './components/Navbar';\r\nimport { BrowserRouter as Router, Switch } from 'react-router-dom';\r\n\r\n\r\nimport Editor from './components/Editor'\r\nimport useLocalStorage from './hooks/useLocalStorage'\r\n\r\nfunction App() {\r\n  const [html, setHtml] = useLocalStorage('html', '')\r\n  // const [css, setCss] = useLocalStorage('css', '')\r\n  // const [js, setJs] = useLocalStorage('js', '')\r\n  const [srcDoc, setSrcDoc] = useState('')\r\n  const Conversion = \"\\\\\";\r\n  \r\n  \r\n  useEffect(() => {\r\n    // function getHTMLFromServer(){\r\n    //   const doc = fetch('http://127.0.0.1:5000/getHTML')\r\n    //    .then(function(response) {\r\n    //       return response.text()\r\n    //   })\r\n    //   .catch(function(err) {\r\n    //   console.log(err);\r\n    //    })\r\n    //    .then(\r\n    //     res => {\r\n    //       setHtml(res)\r\n    //     }\r\n    //   );\r\n    //   console.log(doc)\r\n    //   return doc\r\n    // }\r\n    // getHTMLFromServer()\r\n\r\n    const timeout = setTimeout(() => {\r\n      \r\n      setSrcDoc(`\r\n        ${html}\r\n        <style>\r\n        *{\r\n          -moz-user-select:none;/*火狐*/\r\n          -webkit-user-select:none;/*webkit浏览器*/\r\n          -ms-user-select:none;/*IE10*/\r\n          -khtml-user-select:none;/*早期浏览器*/\r\n            user-select:none;\r\n      }\r\n        .selected{\r\n          position:relative;\r\n          cursor:pointer;\r\n          }\r\n       .selected:after{\r\n            }\r\n       .selected:hover:after{\r\n          position:absolute;\r\n          left:0;\r\n          width:100%;\r\n          height:100%;\r\n          background-color:red;\r\n          opacity:.3;\r\n          pointer-events: none;\r\n          content:\"\"\r\n         }\r\n        </style>\r\n        <script>\r\n      \r\n      \r\n   \r\n        function countNum(arr,element){\r\n           let count = 0;\r\n           for(let i=0;i<arr.length;i++){\r\n              if(arr[i]==element){\r\n                count++\r\n              }\r\n           }\r\n           return count\r\n        }\r\n\r\n        function getLine(word,wordNum){\r\n          let html = localStorage.getItem(\"codepen-clone-html\");\r\n          let stack =[]\r\n          let line=1;\r\n          for(let i=0;i<html.length;i++){\r\n            //判断首字母相同\r\n            if(word[0]==html[i]){\r\n                      \r\n            //判断字符出现的位置，并限定字符出现在><之间\r\n            if(html.substr(i,word.length)==word&&html[i-1]==\">\"&&html[i+word.length]==\"<\"){\r\n                stack.push([i])\r\n                i=i+word.length\r\n            }\r\n           }\r\n          }\r\n          let ch = 0;\r\n          for(let i=0;i<=stack[wordNum];i++){\r\n            if(html[i]!=\"${Conversion}${Conversion}\"){\r\n              ch++\r\n            }\r\n            if(html.substr(i,2)==\"${Conversion}${Conversion}n\"){\r\n              line++\r\n              ch=0;\r\n           }\r\n          }\r\n          return JSON.stringify({\r\n            line: line-1,\r\n            ch: ch-2+word.length\r\n          })\r\n        }\r\n        \r\n        window.addEventListener('scroll', function() {\r\n          localStorage.setItem(\"scrollTop\", document.documentElement.scrollTop)\r\n        })\r\n\r\n        window.onload=function(){\r\n          let stack=[];\r\n\r\n          let allEvent = document.getElementsByTagName(\"*\");\r\n\r\n          //获取编辑器\r\n          let editor = window.parent.document.querySelector('.CodeMirror').CodeMirror; \r\n          document.documentElement.scrollTop = localStorage.getItem(\"scrollTop\")\r\n          \r\n          //获取navbar\r\n          let navbar = window.parent.document.getElementsByClassName(\"navbar\")[0]\r\n          let navbarMenu = window.parent.document.getElementsByClassName(\"nav-menu\")[0]\r\n          let menuBars = window.parent.document.getElementsByClassName(\"menu-bars\")[0]\r\n\r\n          //防止editor失去焦点\r\n          document.onmousedown=function(event){\r\n            event.preventDefault();\r\n          }\r\n          navbar.onmousedown=function(event){\r\n            event.preventDefault();\r\n          }\r\n          // navbarMenu.onmousedown=function(event){\r\n          //   event.preventDefault();\r\n          // }\r\n          menuBars.onmousedown=function(event){\r\n            event.preventDefault();\r\n          }\r\n          \r\n\r\n          for(let i=0;i<allEvent.length;i++){\r\n            //选择内容非空且没有孩子元素的节点\r\n            if(allEvent[i].children.length==0 && allEvent[i].innerHTML!=\"\"){\r\n                stack.push(allEvent[i].innerHTML);\r\n                allEvent[i].classList.add('selected');\r\n                allEvent[i].setAttribute(\"selectedId\",countNum(stack,allEvent[i].innerHTML)-1);   \r\n                allEvent[i].onclick=function(e){\r\n                  \r\n                  //防止失去焦点\r\n                  e.preventDefault();\r\n \r\n                  //阻止冒泡\r\n                  e.stopPropagation();\r\n                  localStorage.setItem(\"location\",getLine(this.innerHTML,parseInt(this.getAttribute(\"selectedId\"))));    \r\n                  console.log(localStorage.getItem(\"location\"))\r\n                  editor.setCursor(JSON.parse(localStorage.getItem(\"location\")));\r\n              }                \r\n            }          \r\n          \r\n           }                       \r\n          }\r\n          </script>\r\n      `)\r\n\r\n    }, 250) \r\n    \r\n    return () => {\r\n      clearTimeout(timeout)\r\n      // clearInterval(timer)\r\n    }\r\n  }, [html])\r\n \r\n return (\r\n  <>\r\n      <Router>\r\n        <Navbar />\r\n        <Switch>\r\n        </Switch>\r\n      </Router>\r\n    <div id=\"onlineEditor\" className=\"pane_editor top-pane\">\r\n      <Editor\r\n        language=\"xml\"\r\n        displayName=\"HTML\"\r\n        value={html}  \r\n        onChange={setHtml}\r\n      />\r\n    </div>\r\n    <div className=\"pane_iframe\">\r\n      <iframe\r\n        id=\"iframe\"\r\n        srcDoc={srcDoc}\r\n        title=\"output\"\r\n        sandbox=\"allow-scripts allow-same-origin\"\r\n        frameBorder=\"0\"\r\n        width=\"100%\"\r\n        height=\"100%\"\r\n      />\r\n    </div>\r\n  </>\r\n)\r\n}\r\n \r\n\r\n\r\nexport default App;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAO,WAAW;AAClB,OAAOC,MAAM,MAAM,qBAAqB;AACxC,SAASC,aAAa,IAAIC,MAAM,EAAEC,MAAM,QAAQ,kBAAkB;AAGlE,OAAOC,MAAM,MAAM,qBAAqB;AACxC,OAAOC,eAAe,MAAM,yBAAyB;AAAA;AAAA;AAErD,SAASC,GAAG,GAAG;EAAA;EACb,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGH,eAAe,CAAC,MAAM,EAAE,EAAE,CAAC;EACnD;EACA;EACA,MAAM,CAACI,MAAM,EAAEC,SAAS,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAMa,UAAU,GAAG,IAAI;EAGvBZ,SAAS,CAAC,MAAM;IACd;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA,MAAMa,OAAO,GAAGC,UAAU,CAAC,MAAM;MAE/BH,SAAS,CAAE;AACjB,UAAUH,IAAK;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2BI,UAAW,GAAEA,UAAW;AACnD;AACA;AACA,oCAAoCA,UAAW,GAAEA,UAAW;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,CAAC;IAEJ,CAAC,EAAE,GAAG,CAAC;IAEP,OAAO,MAAM;MACXG,YAAY,CAACF,OAAO,CAAC;MACrB;IACF,CAAC;EACH,CAAC,EAAE,CAACL,IAAI,CAAC,CAAC;EAEX,oBACC;IAAA,wBACI,QAAC,MAAM;MAAA,wBACL,QAAC,MAAM;QAAA;QAAA;QAAA;MAAA,QAAG,eACV,QAAC,MAAM;QAAA;QAAA;QAAA;MAAA,QACE;IAAA;MAAA;MAAA;MAAA;IAAA,QACF,eACX;MAAK,EAAE,EAAC,cAAc;MAAC,SAAS,EAAC,sBAAsB;MAAA,uBACrD,QAAC,MAAM;QACL,QAAQ,EAAC,KAAK;QACd,WAAW,EAAC,MAAM;QAClB,KAAK,EAAEA,IAAK;QACZ,QAAQ,EAAEC;MAAQ;QAAA;QAAA;QAAA;MAAA;IAClB;MAAA;MAAA;MAAA;IAAA,QACE,eACN;MAAK,SAAS,EAAC,aAAa;MAAA,uBAC1B;QACE,EAAE,EAAC,QAAQ;QACX,MAAM,EAAEC,MAAO;QACf,KAAK,EAAC,QAAQ;QACd,OAAO,EAAC,iCAAiC;QACzC,WAAW,EAAC,GAAG;QACf,KAAK,EAAC,MAAM;QACZ,MAAM,EAAC;MAAM;QAAA;QAAA;QAAA;MAAA;IACb;MAAA;MAAA;MAAA;IAAA,QACE;EAAA,gBACL;AAEL;AAAC,GAlMQH,GAAG;EAAA,QACcD,eAAe;AAAA;AAAA,KADhCC,GAAG;AAsMZ,eAAeA,GAAG;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}